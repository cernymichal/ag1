#include <cassert>
#include <iostream>

#include "guard.cpp"

using TestCase = std::pair<uint64_t, TreeProblem>;

const std::vector<TestCase> BASIC_TESTS = {
    {3, {1, {1, 1, 1, 2}, {{0, 3}, {1, 3}, {2, 3}}}},
    {4, {1, {1, 1, 1, 4}, {{0, 3}, {1, 3}, {2, 3}}}},
    {57, {1, {
                 17,
                 11,
                 5,
                 13,
                 8,
                 12,
                 7,
                 4,
                 2,
                 8,
             },
          {
              {1, 4},
              {6, 1},
              {2, 1},
              {3, 8},
              {8, 0},
              {6, 0},
              {5, 6},
              {7, 2},
              {0, 9},
          }}},
    {85, {1, {
                 10,
                 16,
                 13,
                 4,
                 19,
                 8,
                 18,
                 17,
                 18,
                 19,
                 10,
             },
          {
              {9, 7},
              {9, 6},
              {10, 4},
              {4, 9},
              {7, 1},
              {0, 2},
              {9, 2},
              {3, 8},
              {2, 3},
              {5, 4},
          }}},
    {79, {1, {
                 8,
                 14,
                 11,
                 8,
                 1,
                 13,
                 9,
                 14,
                 15,
                 12,
                 1,
                 11,
             },
          {
              {9, 1},
              {1, 2},
              {1, 4},
              {5, 10},
              {7, 8},
              {3, 7},
              {11, 3},
              {11, 10},
              {6, 8},
              {0, 1},
              {0, 3},
          }}},
    {102, {1, {
                  15,
                  10,
                  18,
                  18,
                  3,
                  4,
                  18,
                  12,
                  6,
                  19,
                  9,
                  19,
                  10,
              },
           {
               {10, 2},
               {11, 10},
               {6, 3},
               {10, 8},
               {5, 3},
               {11, 1},
               {9, 5},
               {0, 4},
               {12, 3},
               {9, 7},
               {11, 9},
               {4, 12},
           }}},
    {93, {1, {
                 1,
                 7,
                 6,
                 18,
                 15,
                 2,
                 14,
                 15,
                 18,
                 8,
                 15,
                 1,
                 5,
                 6,
             },
          {
              {0, 13},
              {6, 12},
              {0, 12},
              {7, 8},
              {8, 3},
              {12, 11},
              {12, 1},
              {10, 12},
              {2, 6},
              {6, 9},
              {12, 7},
              {0, 4},
              {0, 5},
          }}},
};

const std::vector<TestCase> BONUS_TESTS = {
    {3, {2, {1, 1, 1, 2}, {{0, 3}, {1, 3}, {2, 3}}}},
    {5, {2, {1, 1, 1, 4}, {{0, 3}, {1, 3}, {2, 3}}}},
    {927, {2, {64, 112, 117, 174, 168, 105, 118, 128, 181, 6}, {{8, 7}, {7, 9}, {0, 7}, {8, 5}, {0, 6}, {6, 3}, {6, 2}, {6, 4}, {3, 1}}}},
    {943, {2, {166, 95, 146, 129, 62, 168, 32, 145, 44, 97}, {{8, 4}, {8, 9}, {3, 8}, {8, 1}, {6, 9}, {9, 7}, {0, 9}, {2, 3}, {5, 1}}}},
    {681, {1, {105, 114, 143, 185, 6, 63, 161, 186, 124, 102}, {{0, 9}, {0, 3}, {0, 7}, {9, 2}, {5, 7}, {7, 1}, {5, 8}, {5, 4}, {6, 8}}}},
    {719, {2, {175, 82, 145, 101, 122, 86, 18, 103, 8, 146}, {{5, 4}, {7, 5}, {5, 2}, {0, 4}, {4, 8}, {4, 1}, {2, 6}, {2, 9}, {2, 3}}}},
    {970, {2, {55, 132, 162, 164, 63, 181, 136, 87, 185, 7}, {{1, 3}, {4, 3}, {3, 8}, {1, 2}, {1, 0}, {5, 1}, {9, 2}, {2, 6}, {7, 0}}}},
    {705, {2, {32, 55, 85, 50, 23, 32, 197, 117, 138, 31}, {{4, 0}, {0, 5}, {7, 0}, {9, 4}, {4, 6}, {4, 8}, {3, 5}, {5, 1}, {2, 5}}}},
    {1276, {2, {177, 175, 24, 198, 144, 186, 13, 156, 178, 182}, {{4, 3}, {9, 3}, {6, 4}, {8, 4}, {4, 7}, {5, 6}, {0, 6}, {6, 2}, {5, 1}}}},
    {1037, {2, {56, 153, 90, 166, 35, 195, 153, 190, 59, 183}, {{1, 0}, {7, 0}, {0, 2}, {6, 1}, {1, 5}, {2, 4}, {2, 8}, {2, 9}, {3, 5}}}},
    {618, {1, {69, 15, 107, 37, 70, 17, 159, 19, 196, 186}, {{6, 3}, {9, 6}, {1, 9}, {2, 9}, {9, 0}, {5, 1}, {5, 7}, {7, 4}, {7, 8}}}},
    {561, {1, {47, 49, 24, 54, 180, 132, 10, 178, 85, 14}, {{7, 1}, {2, 1}, {8, 1}, {6, 7}, {7, 3}, {8, 9}, {8, 5}, {9, 4}, {0, 9}}}},
};

void test(const std::vector<TestCase>& T) {
    int i = 0;
    for (auto& [s, t] : T) {
        if (s != solve(t))
            std::cout << "Error in " << i << " (returned " << solve(t) << ")" << std::endl;
        i++;
    }
    //std::cout << "Finished" << std::endl;
}

int main() {
    test(BASIC_TESTS);
    test(BONUS_TESTS);

    std::cout << "All tests completed" << std::endl;
}
